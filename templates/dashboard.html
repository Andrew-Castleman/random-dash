<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Apartment Deals â€” SF & Stanford Area</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:wght@600;700&family=Lora:wght@400;600&display=swap" rel="stylesheet">
  <!-- AdSense is injected only on portal tabs (SF Listings, Stanford Area) via dashboard.js -->
</head>
<body>
  <div class="dashboard">
    <header class="dashboard-header">
      <div class="header-row">
        <div>
          <h1>Apartment Deals</h1>
          <p class="dashboard-tagline">SF & Stanford area listings with deal scores</p>
        </div>
        <div class="header-actions">
          <span class="dashboard-updated" id="lastUpdated">Last refreshed: never</span>
          <button type="button" class="btn-refresh" id="btnRefresh" aria-label="Refresh data">
            <span class="btn-refresh-icon">ğŸ”„</span>
            <span class="btn-refresh-text">Refresh Data</span>
            <span class="btn-refresh-spinner" aria-hidden="true"></span>
          </button>
        </div>
      </div>
      <p class="stale-warning hidden" id="staleWarning">Data is older than 10 minutes. Click Refresh Data for latest.</p>
    </header>

    <div class="toast" id="toast" role="status" aria-live="polite"></div>

    <div class="dashboard-tabs">
      <button type="button" class="tab-btn active" data-tab="apartments" aria-selected="true">ğŸ  SF Listings</button>
      <button type="button" class="tab-btn" data-tab="stanford-apartments" aria-selected="false">ğŸ“ Stanford Area</button>
      <button type="button" class="tab-btn" data-tab="apartments-alt" aria-selected="false">ğŸ  SF Listings (alternate)</button>
      <button type="button" class="tab-btn" data-tab="stanford-apartments-alt" aria-selected="false">ğŸ“ Stanford Area (alternate)</button>
      <button type="button" class="tab-btn tab-btn--secondary" data-tab="markets" aria-selected="false">ğŸ“Š Markets</button>
    </div>

    <div class="tab-content" id="markets-tab">
    <main class="dashboard-grid">
      <section class="widget widget--summary" aria-labelledby="summary-title">
        <h2 class="widget-title" id="summary-title">ğŸ“Š Portfolio Performance Summary</h2>
        <div class="widget-body" id="widget-summary">
          <div class="widget-loading" data-widget="summary">Loadingâ€¦</div>
        </div>
      </section>

      <section class="widget widget--movers" aria-labelledby="movers-title">
        <h2 class="widget-title" id="movers-title">ğŸ“ˆ Top 3 Movers in Portfolio</h2>
        <div class="widget-body" id="widget-movers">
          <div class="widget-loading" data-widget="movers">Loadingâ€¦</div>
        </div>
      </section>

      <section class="widget widget--vs-market" aria-labelledby="vs-market-title">
        <h2 class="widget-title" id="vs-market-title">ğŸ“‰ Portfolio vs Market (SPY)</h2>
        <div class="widget-body" id="widget-vs-market">
          <div class="widget-loading" data-widget="vs-market">Loadingâ€¦</div>
        </div>
      </section>

      <section class="widget widget--trending" aria-labelledby="trending-title">
        <h2 class="widget-title" id="trending-title">ğŸ”¥ Trending Now</h2>
        <div class="widget-body" id="widget-trending">
          <div class="widget-loading" data-widget="trending">Loadingâ€¦</div>
        </div>
      </section>

      <section class="widget widget--gainers" aria-labelledby="gainers-title">
        <h2 class="widget-title" id="gainers-title">ğŸš€ Top Gainers</h2>
        <div class="widget-body" id="widget-gainers">
          <div class="widget-loading" data-widget="gainers">Loadingâ€¦</div>
        </div>
      </section>

      <section class="widget widget--losers" aria-labelledby="losers-title">
        <h2 class="widget-title" id="losers-title">âš ï¸ Top Losers</h2>
        <div class="widget-body" id="widget-losers">
          <div class="widget-loading" data-widget="losers">Loadingâ€¦</div>
        </div>
      </section>

      <section class="widget widget--calendar" aria-labelledby="calendar-title">
        <div class="widget-body economic-calendar-widget" id="widget-calendar">
          <h2 class="economic-calendar-widget__heading" id="calendar-title">ğŸ“Š Economic Calendar</h2>
          <div class="econ-grid">
            <div class="econ-section">
              <h3 class="econ-section__title">Last 3 Releases</h3>
              <div id="recentEconCards" class="econ-cards"></div>
            </div>
            <div class="econ-section">
              <h3 class="econ-section__title">Next 5 Events</h3>
              <div id="upcomingEconCards" class="econ-cards"></div>
            </div>
          </div>
        </div>
      </section>

      <section class="widget widget--portfolio widget--full" aria-labelledby="portfolio-title">
        <h2 class="widget-title" id="portfolio-title">ğŸ’° Portfolio (7 Companies)</h2>
        <div class="widget-body" id="widget-portfolio">
          <div class="widget-loading" data-widget="portfolio">Loadingâ€¦</div>
        </div>
      </section>
    </main>
    </div>

    <div class="tab-content active" id="apartments-tab">
      <div class="apartments-container">
        <div class="apartments-header">
          <div>
            <h2 class="apartments-title">ğŸ  SF Listings</h2>
            <p class="range-subtitle">Listings in San Francisco â€” $2,000 â€“ $5,000/month</p>
          </div>
          <button type="button" id="refreshApartments" class="refresh-btn">ğŸ”„ Refresh Listings</button>
        </div>
        <div class="apartments-filters">
          <select id="neighborhoodFilter" aria-label="Filter by area">
            <option value="all">All Areas</option>
            <!-- Populated dynamically from API data -->
          </select>
          <select id="bedroomFilter" aria-label="Filter by bedrooms">
            <option value="all">All Bedrooms</option>
            <option value="studio">Studio</option>
            <option value="1">1 Bedroom</option>
            <option value="2">2 Bedrooms</option>
            <option value="3">3+ Bedrooms</option>
          </select>
          <select id="sortBy" aria-label="Sort by">
            <option value="best-deal">Best Deal Score</option>
            <option value="price-low">Lowest Price</option>
            <option value="price-sqft">Price per Sqft</option>
            <option value="newest">Newest First</option>
          </select>
        </div>
        <div id="sfMapContainer" class="listings-map-container"></div>
        <div class="apartments-stats">
          <div class="stat">
            <span class="stat-label">Total Listings</span>
            <span class="stat-value" id="totalListings">0</span>
          </div>
          <div class="stat">
            <span class="stat-label">Excellent Deals</span>
            <span class="stat-value" id="excellentDeals">0</span>
          </div>
          <div class="stat">
            <span class="stat-label">Average Price</span>
            <span class="stat-value" id="avgPrice">$0</span>
          </div>
        </div>
        <div id="apartmentsList" class="apartments-grid"></div>
      </div>
    </div>

    <div class="tab-content" id="stanford-apartments-tab">
      <div class="apartments-container">
        <div class="apartments-header">
          <div>
            <h2 class="apartments-title">ğŸ“ Stanford Area Listings</h2>
            <p class="range-subtitle">Palo Alto, Menlo Park, Redwood City â€” $1,500 â€“ $6,500/month (incl. 2BR)</p>
          </div>
          <button type="button" id="refreshStanfordApartments" class="refresh-btn">ğŸ”„ Refresh Listings</button>
        </div>
        <div class="apartments-filters">
          <select id="stanfordNeighborhoodFilter" aria-label="Filter by neighborhood">
            <option value="all">All Areas</option>
            <option value="palo-alto">Palo Alto</option>
            <option value="menlo-park">Menlo Park</option>
            <option value="redwood-city">Redwood City</option>
            <option value="mountain-view">Mountain View</option>
            <option value="stanford">Stanford</option>
            <option value="east-palo-alto">East Palo Alto</option>
          </select>
          <select id="stanfordBedroomFilter" aria-label="Filter by bedrooms">
            <option value="all">All Bedrooms</option>
            <option value="studio">Studio</option>
            <option value="1">1 Bedroom</option>
            <option value="2">2 Bedrooms</option>
            <option value="3">3+ Bedrooms</option>
          </select>
          <select id="stanfordSortBy" aria-label="Sort by">
            <option value="best-deal">Best Deal Score</option>
            <option value="price-low">Lowest Price</option>
            <option value="price-sqft">Price per Sqft</option>
            <option value="newest">Newest First</option>
          </select>
        </div>
        <div id="stanfordMapContainer" class="listings-map-container"></div>
        <div class="apartments-stats">
          <div class="stat">
            <span class="stat-label">Total Listings</span>
            <span class="stat-value" id="stanfordTotalListings">0</span>
          </div>
          <div class="stat">
            <span class="stat-label">Excellent Deals</span>
            <span class="stat-value" id="stanfordExcellentDeals">0</span>
          </div>
          <div class="stat">
            <span class="stat-label">Average Price</span>
            <span class="stat-value" id="stanfordAvgPrice">$0</span>
          </div>
        </div>
        <div id="stanfordApartmentsList" class="apartments-grid"></div>
      </div>
    </div>

    <div class="tab-content" id="apartments-alt-tab">
      <div class="apartments-container">
        <div class="apartments-header">
          <div>
            <h2 class="apartments-title">ğŸ  SF Listings (alternate)</h2>
            <p class="range-subtitle">Listings in San Francisco â€” $2,000 â€“ $5,000/month</p>
          </div>
          <button type="button" id="refreshApartmentsAlt" class="refresh-btn">ğŸ”„ Refresh Listings</button>
        </div>
        <div class="apartments-filters">
          <select id="neighborhoodFilterAlt" aria-label="Filter by neighborhood">
            <option value="all">All Neighborhoods</option>
            <option value="mission">Mission</option>
            <option value="soma">SoMa</option>
            <option value="nob-hill">Nob Hill</option>
            <option value="marina">Marina</option>
            <option value="sunset">Sunset</option>
            <option value="richmond">Richmond</option>
            <option value="castro">Castro</option>
            <option value="haight">Haight-Ashbury</option>
            <option value="pac-heights">Pacific Heights</option>
            <option value="inner-sunset">Inner Sunset</option>
          </select>
          <select id="bedroomFilterAlt" aria-label="Filter by bedrooms">
            <option value="all">All Bedrooms</option>
            <option value="studio">Studio</option>
            <option value="1">1 Bedroom</option>
            <option value="2">2 Bedrooms</option>
            <option value="3">3+ Bedrooms</option>
          </select>
          <select id="sortByAlt" aria-label="Sort by">
            <option value="best-deal">Best Deal Score</option>
            <option value="price-low">Lowest Price</option>
            <option value="price-sqft">Price per Sqft</option>
            <option value="newest">Newest First</option>
          </select>
        </div>
        <div class="cl-map-notice">
          <div class="cl-map-notice-content">
            <span class="cl-map-notice-icon">ğŸ—ºï¸</span>
            <div>
              <strong>Map Feature:</strong> For interactive maps with precise locations, please visit the listing on Craigslist directly. Click "View Listing" on any card below to access the full Craigslist page with map features.
            </div>
          </div>
        </div>
        <div class="apartments-stats">
          <div class="stat">
            <span class="stat-label">Total Listings</span>
            <span class="stat-value" id="totalListingsAlt">0</span>
          </div>
          <div class="stat">
            <span class="stat-label">Excellent Deals</span>
            <span class="stat-value" id="excellentDealsAlt">0</span>
          </div>
          <div class="stat">
            <span class="stat-label">Average Price</span>
            <span class="stat-value" id="avgPriceAlt">$0</span>
          </div>
        </div>
        <div id="apartmentsListAlt" class="apartments-grid"></div>
      </div>
    </div>

    <div class="tab-content" id="stanford-apartments-alt-tab">
      <div class="apartments-container">
        <div class="apartments-header">
          <div>
            <h2 class="apartments-title">ğŸ“ Stanford Area Listings (alternate)</h2>
            <p class="range-subtitle">Palo Alto, Menlo Park, Redwood City â€” $1,500 â€“ $6,500/month (incl. 2BR)</p>
          </div>
          <button type="button" id="refreshStanfordApartmentsAlt" class="refresh-btn">ğŸ”„ Refresh Listings</button>
        </div>
        <div class="apartments-filters">
          <select id="stanfordNeighborhoodFilterAlt" aria-label="Filter by neighborhood">
            <option value="all">All Areas</option>
            <option value="palo-alto">Palo Alto</option>
            <option value="menlo-park">Menlo Park</option>
            <option value="redwood-city">Redwood City</option>
            <option value="mountain-view">Mountain View</option>
            <option value="stanford">Stanford</option>
            <option value="east-palo-alto">East Palo Alto</option>
          </select>
          <select id="stanfordBedroomFilterAlt" aria-label="Filter by bedrooms">
            <option value="all">All Bedrooms</option>
            <option value="studio">Studio</option>
            <option value="1">1 Bedroom</option>
            <option value="2">2 Bedrooms</option>
            <option value="3">3+ Bedrooms</option>
          </select>
          <select id="stanfordSortByAlt" aria-label="Sort by">
            <option value="best-deal">Best Deal Score</option>
            <option value="price-low">Lowest Price</option>
            <option value="price-sqft">Price per Sqft</option>
            <option value="newest">Newest First</option>
          </select>
        </div>
        <div class="cl-map-notice">
          <div class="cl-map-notice-content">
            <span class="cl-map-notice-icon">ğŸ—ºï¸</span>
            <div>
              <strong>Map Feature:</strong> For interactive maps with precise locations, please visit the listing on Craigslist directly. Click "View Listing" on any card below to access the full Craigslist page with map features.
            </div>
          </div>
        </div>
        <div class="apartments-stats">
          <div class="stat">
            <span class="stat-label">Total Listings</span>
            <span class="stat-value" id="stanfordTotalListingsAlt">0</span>
          </div>
          <div class="stat">
            <span class="stat-label">Excellent Deals</span>
            <span class="stat-value" id="stanfordExcellentDealsAlt">0</span>
          </div>
          <div class="stat">
            <span class="stat-label">Average Price</span>
            <span class="stat-value" id="stanfordAvgPriceAlt">$0</span>
          </div>
        </div>
        <div id="stanfordApartmentsListAlt" class="apartments-grid"></div>
      </div>
    </div>

    <footer class="site-footer">
      <a href="/about">About</a>
      <a href="/privacy">Privacy Policy</a>
      <a href="/terms">Terms of Service</a>
      <a href="/contact">Contact</a>
    </footer>
  </div>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script src="{{ url_for('static', filename='dashboard.js') }}"></script>
</body>
</html>
